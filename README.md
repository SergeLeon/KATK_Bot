# KATK_Bot

[Бот в ВК](https://vk.com/katk44bot) <br>
[Бот в Telegram](https://t.me/KATK44bot) <br>

[Руководство пользователя в ВК](https://vk.com/@katk44bot-rukovodstvo-polzovatelya)

### Информация:

Бот, отправляющий изменения выбранной пользователем группы в учебном
[расписании Костромского автотранспортного колледжа](https://katt44.ru/index.php?option=com_content&view=article&id=252&Itemid=129)
в настроенных сервисах.

Возможно использование и в других учебных заведениях. Для этого требуется изменить
***data_parser.py*** сохранив интерфейс взаимодействия.

### Возможности:

- Отправка расписания выбранной пользователем учебной группы.
- Одинаковая работа как в лс, так и в беседе.
- Форматирование расписания по выбранному шаблону (на данный момент 3).
- Работа со многими пользователями.
- Возможность неограниченного добавления сервисов взаимодействия с пользователем
- Работа с расписанием из xlsx документов

### Структура проекта:

- ***main.py*** - точка входа в приложение. <br>
  Запускает:
    - **event_loop** - реализован в ***main.py***, обрабатывает и отвечает на события происходящие при работе бота.
    - **parsing_loop** - реализован в ***main.py***, проверяет изменения в расписании.
    - **vk_bot_loop** - реализован в ***vk_bot.py***, обрабатывает логику взаимодействия с пользователем в ВК.
    - **tg_bot_loop** - реализован в ***tg_bot.py***, обрабатывает логику взаимодействия с пользователем в Telegram.
- ***vk_bot.py*** - Взаимодействие с пользователем в ВК.
- ***tg_bot.py*** - Взаимодействие с пользователем в Telegram.
- ***data_parser.py*** - Получение таблиц с расписанием.
- ***table_formatter.py*** - Форматирование таблиц с расписанием.
- ***database.py*** - Работа с базой данных. <br>
  Поля базы данных таблицы **groups**:
    - **user_id** _INT_ - id беседы или пользователя.
    - **name** _TEXT_ - Установленная группа (берется из расписания).
    - **adv** _INT_ - **1** отправлять обновления / **0** не отправлять.
    - **style_id** _INT_ - id стиля форматирования.
    - ***service_name*** - Имя сервиса взаимодействия с пользователем.
- ***logger.py*** - Логирование приложения.
- ***config.py*** - Конфигурационный файл.
- ***message_templates.py*** - Шаблоны сообщений
- ***event.py*** - Типы событий

### Что планируется:

- ~~Бот в Телеграмме (*по мере необходимости*)~~
- Новые стили форматирования:
    - в виде изображения (png)
    - ???
- Вынести логику **event_loop** и **parsing_loop** в отдельные модули.
- Админ панель

